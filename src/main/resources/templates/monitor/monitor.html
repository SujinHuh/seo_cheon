<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<body class="bg-light">
<div class="container">

    <div class="container">

        <div class="row">
            <!--            <div class="col-md-1"></div>-->
            <div class="col-md-9">

                <!--       table Start        -->

                <table class="tg" style="table-layout: fixed; width: 720px">
                    <colgroup>
                        <col style="width: 180px">
                        <col style="width: 150px">
                        <col style="width: 150px">
                        <col style="width: 200px">
                        <col style="width: 150px">
                        <col style="width: 150px">
                        <col style="width: 300px">
                        <!--                        <col style="width: 200px">-->
                        <!--                        <col style="width: 180px">-->
                        <!--                        <col style="width: 180px">-->
                        <!--                        <col style="width: 300px">-->
                        <!--                        <col style="width: 200px">-->
                        <!--                        <col style="width: 200px">-->
                        <!--                        <col style="width: 450px">-->
                    </colgroup>
                    <thead>
                    <tr>
                        <th class="tg-nrix"></th>
                        <th class="tg-9wq8"><span style="font-weight:400;font-style:normal">Wind Dir</span></th>
                        <th class="tg-9wq8"><span style="font-weight:200;font-style:normal">Wind Spd</span></th>
                        <th class="tg-9wq8"><span style="font-weight:400;font-style:normal">Lux</span></th>
                        <th class="tg-9wq8"><span style="font-weight:400;font-style:normal">Temp</span></th>
                        <th class="tg-9wq8"><span style="font-weight:400;font-style:normal">Humidity</span></th>
                        <th class="tg-9wq8"><span style="font-weight:400;font-style:normal">RCV Time</span></th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td class="tg-9wq8"><span style="font-weight:400;font-style:normal">
                            <button type="button" onclick="realTimeGraphpopup('ID2001')" class="btn btn-link btn-lg"
                                    style = "font-weight: bolder; font-size: larger" >
                            ID 2001</button>
                        </span>
                        </td>
                        <td class="tg-9wq8">
                            <span id="id2001_windDir"></span>
                        </td>
                        <td class="tg-9wq8">
                            <span id="id2001_windSpeed">
                            </span>
                        </td>
                        <td class="tg-9wq8">
                            <span id="id2001_lux"></span>
                        </td>
                        <td class="tg-9wq8">
                            <spqn id="id2001_temp"></spqn>
                        </td>

                        <td class="tg-9wq8">
                            <spqn id="id2001_rhumidity"></spqn>
                        </td>
                        <td class="tg-9wq8">
                            <spqn id="id2001_nowTime"></spqn>
                        </td>
                    </tr>
                    <tr>
                        <td class="tg-9wq8"><span style="font-weight:400;font-style:normal">
                            <button type="button" onclick="realTimeGraphpopup('ID2002')" class="btn btn-link btn-lg"
                                    style = "font-weight: bolder; font-size: larger">
                            ID 2002</button>
                        </span>
                        </td>
                        <td class="tg-9wq8">
                            <span id="id2002_windDir"></span>
                        </td>
                        <td class="tg-9wq8">
                            <span id="id2002_windSpeed">
                            </span>
                        </td>
                        <td class="tg-9wq8">
                            <span id="id2002_lux"></span>
                        </td>
                        <td class="tg-9wq8">
                            <span id="id2002_temp"></span>
                        </td>
                        <td class="tg-9wq8">
                            <span id="id2002_rhumidity"></span>
                        </td>
                        <td class="tg-9wq8">
                            <span id="id2002_nowTime"></span>
                        </td>
                    </tr>
                    <tr>
                        <td class="tg-9wq8"><span style="font-weight:400;font-style:normal">
                            <button type="button" onclick="realTimeGraphpopup('ID2003')" class="btn btn-link btn-lg"
                                    style = "font-weight: bolder; font-size: larger">
                            ID 2003</button>
                        </span>
                        </td>
                        <td class="tg-9wq8">
                            <span id="id2003_windDir"></span>
                        </td>
                        <td class="tg-9wq8">
                            <span id="id2003_windSpeed"></span>
                        </td>
                        <td class="tg-9wq8">
                            <span id="id2003_lux"></span>
                        </td>
                        <td class="tg-9wq8">
                            <span id="id2003_temp"></span>
                        </td>
                        <td class="tg-9wq8">
                            <span id="id2003_rhumidity"></span>
                        </td>
                        <td class="tg-9wq8">
                            <span id="id2003_nowTime"></span>
                        </td>
                    </tr>
                    </tbody>
                </table>
                <!--table End-->
            </div>

            <!--            사진-->
            <div class="col-md-2">
                <img class="imageContainer" th:src="@{/images/home.png}">
            </div>
        </div>
        <br>
    </div>
</div>

</div>
</div>
<script th:src="@{/js/common.js}"></script>
<script th:src="@{/js/moment.min.js}"></script>
<script>

    var windIntervval = null;
    var realTimeInterVal = null;

    function drawWind() {
        console.log('set wind');
        $.ajax({
            url: '/main/data/getWindInfo',
            type: 'post',
            contentType: 'application/json',
            dataType: 'json',
            data: 'windInfo', // null
            success: function (data) {
                if (typeof data.windInfo !== 'undefined') {

                    $.each(data.windInfo, function (index, obj) {
                        if (obj != null) {
                            console.log(obj);
                            if (index == 0) {

                                $('#id2001_windDir').empty().append('<h2>' + obj.windDir + "</h2>");
                                $('#id2001_windSpeed').empty().append('<h2>' + obj.windSpeed + "</h2>");
                                $('#id2001_lux').empty().append('<h2>' + obj.lux + "</h2>");
                                $('#id2001_temp').empty().append('<h2>' + obj.airTemperature + "</h2>");
                                $('#id2001_rhumidity').empty().append('<h2>' + obj.rhumidity + "</h2>");
                                $('#id2001_nowTime').empty().append('<h2>' + obj.nowTime + "</h2>");
                            } else if (index == 1) {
                                $('#id2002_windDir').empty().append('<h2>' + obj.windDir + "</h2>");
                                $('#id2002_windSpeed').empty().append('<h2>' + obj.windSpeed + "</h2>");
                                $('#id2002_lux').empty().append('<h2>' + obj.lux + "</h2>");
                                $('#id2002_temp').empty().append('<h2>' + obj.airTemperature + "</h2>");
                                $('#id2002_rhumidity').empty().append('<h2>' + obj.rhumidity + "</h2>");
                                $('#id2002_nowTime').empty().append('<h2>' + obj.nowTime + "</h2>");
                            } else if (index == 2) {
                                $('#id2003_windDir').empty().append('<h2>' + obj.windDir + "</h2>");
                                $('#id2003_windSpeed').empty().append('<h2>' + obj.windSpeed + "</h2>");
                                $('#id2003_lux').empty().append('<h2>' + obj.lux + "</h2>");
                                $('#id2003_temp').empty().append('<h2>' + obj.airTemperature + "</h2>");
                                $('#id2003_rhumidity').empty().append('<h2>' + obj.rhumidity + "</h2>");
                                $('#id2003_nowTime').empty().append('<h2>' + obj.nowTime + "</h2>");
                            }
                        }
                        else {
                            //값이 없으면 표시 안하도록 변경
                            if (index == 0) {
                                $('#id2001_windDir').empty().append('<h4>' + ' - ' + "</h4>");
                                $('#id2001_windSpeed').empty().append('<h4>' + ' - ' + "</h4>");
                                $('#id2001_lux').empty().append('<h4>' + ' - ' + "</h4>");
                                $('#id2001_temp').empty().append('<h4>' + ' - ' + "</h4>");
                                $('#id2001_rhumidity').empty().append('<h4>' + ' - ' + "</h4>");
                                $('#id2001_nowTime').empty().append('<h4>' + ' - ' + "</h4>");

                            } else if (index == 1) {
                                $('#id2002_windDir').empty().append('<h4>' + ' - ' + "</h4>");
                                $('#id2002_windSpeed').empty().append('<h4>' + ' - ' + "</h4>");
                                $('#id2002_lux').empty().append('<h4>' + ' - ' + "</h4>");
                                $('#id2002_temp').empty().append('<h4>' + ' - ' + "</h4>");
                                $('#id2002_rhumidity').empty().append('<h4>' + ' - ' + "</h4>");
                                $('#id2002_nowTime').empty().append('<h4>' + ' - ' + "</h4>");

                            } else if (index == 2) {
                                $('#id2003_windDir').empty().append('<h4>' + ' - ' + "</h4>");
                                $('#id2003_windSpeed').empty().append('<h4>' + ' - ' + "</h4>");
                                $('#id2003_lux').empty().append('<h4>' + ' - ' + "</h4>");
                                $('#id2003_temp').empty().append('<h4>' + ' - ' + "</h4>");
                                $('#id2003_rhumidity').empty().append('<h4>' + ' - ' + "</h4>");
                                $('#id2003_nowTime').empty().append('<h4>' + ' - ' + "</h4>");
                            }
                        }
                    });
                }
            },
            error: function (request, status, error) {
                console.log(error);
            }
        });
    }


    function setIntervalEVent() {
        windIntervval = setInterval(drawWind, 300000);
        // realTimeInterVal = setInterval(getRealTimedata, 300000);
    }

    function stopInterval() {

        if (typeof windIntervval !== 'undefined') {
            clearInterval(windIntervval);
        }

        //밑에 리얼 타임
        // if (typeof realTimeInterVal !== 'undefined') {
        //     clearInterval(realTimeInterVal);
        // }
    }


    function sensorDataWarningFunction() {
        window.open("/popup/alert", "MsgWindow", "width=1200,height=800");
    }

    function realTimeGraphpopup(sensorId) {
        window.open("/popup/graph?sensorId=" + sensorId, "MsgWindow", "width=1200 ,height=800")
    }


    function getRealTimedata() {
        var param = function () {
            var now = moment(new Date(new Date().toISOString())).format('YYYY-MM-DD 00:00:00');
            var startDate = moment(now).utc().format('YYYY-MM-DD HH:mm:ss');
            var endDate = moment(startDate).add(24, 'hours').format('YYYY-MM-DD HH:mm:ss');

            var result = {
                startDate: startDate,
                endDate: endDate
            }
            return result;
        }
        // $.ajax({
        //     url: '/main/data/realTimeData',
        //     type: 'post',
        //     dataType: 'json',
        //     data: param(),
        //     success: function (data) {
        //         console.log('set realTime');
        //         if (typeof data.dataList !== 'undefined') {
        //             var realTimeDiv = $('#realTimeData');
        //             realTimeDiv.empty();
        //             $.each(data.dataList, function (index, obj) {
        //                 var contents = $('<span style="font-size:37px;"></span>');
        //                 var idValue = 'list-item-' + (index + 1);
        //                 var value = 'sensorId : ' + obj.sensorId +
        //                     ",  windDir : " + obj.windDir + ",  windSpeed : " + obj.windSpeed +
        //                     ",  lux : " + obj.lux + ",  rHumidity : " + obj.rhumidity + ",  date : " + obj.nowTime; //rhumidity --카멜식 오류 수정
        //
        //                 contents.attr('id', idValue);
        //                 contents.text(value);
        //                 realTimeDiv.append(contents);
        //
        //
        //             });
        //         }
        //     },
        //     error: function (request, status, error) {
        //         console.log(error);
        //     }
        // });
    }


    //시작 함수
    $(document).ready(function () {
        drawWind();
        getRealTimedata();
        //5분갱신 등록
        setIntervalEVent();
    });

</script>
</body>
</html>

